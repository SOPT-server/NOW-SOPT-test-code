# Chapter 6. 테스트 코드의 구성

## 주어진 상황에 따라 결과가 결과가 달라지는 코드

코드는 그 코드가 실행되는 상황에 따라 결과가 달라질 수 있다. 책에서는 숫자야구 게임을 예로 들었다. 코드 내에서 같은 예측을 했더라도 주어진 답이 달랐다면 원하는대로 작동하지 않을 수밖에 없다.

## 테스트 코드의 구성 요소

### 상황, 실행, 결과 확인

테스트 코드를 작성할 때 도움을 주는 기본 골격이다. 흔히 잘 알려진 given, when, then이 각각 상황, 실행, 결과 확인에 대응된다. given에서 상황을 설정을 하고 when에서 코드를 실행하며 then에서 결과를 확인한다.

이때 앞서 나온 @BeforeEach 어노테이션등을 활용해 상황을 설정할 수도 있다.

항상 위 포맷을 따라야 하는 것은 아닌데 **상황이 없는 경우**도 있다. 예전에 나왔던 암호 검사기의 경우 상황이 필요 없이 실행 부터 작성하면 되는데 그 차이는 무언가 초기화 될 필요가 없는 경우라고 보면 될 것 같다.

### 외부 상황과 외부 결과

외부 API 등 외부의 자원을 쓰게 된다면 상황 설정에 있어서 테스트 대상 말고도 고려해야할 것들이 있다. 예를 들어 외부 파일을 읽어오는 경우 해당 파일이 존재하고 제대로 작성돼있다는 것을 보장할 수 있어야 한다. 미리 VCS에 해당 파일을 만들어도 되고 아까 나온 @BeforeEach 등을 이용해 설정을 해도 된다.

개인적으로는 @BeforeEach 등에서 만들고 종료할 때 지우는 편이 깔끔할 것 같다.

외부 상태가 테스트 결과에 영향을 끼치게 될 수도 있는데 해당 부분도 컨트롤 할 수 있다.

일전에 회사에서 테스트 코드를 작성했을 때 dynamodb가 하드코딩 돼 있어서 테스트 실행 결과가 dynamodb에 반영이 되는 일이 있었는데 그때 mock을 이용해서 해결했다.

위 예시처럼 대역을 이용해서 외부 상황이나 결과를 대체할 수 있다
